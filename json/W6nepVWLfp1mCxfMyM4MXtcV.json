{
  "encodedData": "eyJxdWVzdGlvbnMiOlt7InF1ZXN0aW9uIjoiQ29kZSBoZWFydCAwMSIsImNvZGUiOiI8IURPQ1RZUEUgaHRtbD5cclxuPGh0bWwgbGFuZz1cImVuXCI+XHJcblxyXG48aGVhZD5cclxuICAgIDxtZXRhIGNoYXJzZXQ9XCJVVEYtOFwiPlxyXG4gICAgPG1ldGEgbmFtZT1cInZpZXdwb3J0XCIgY29udGVudD1cIndpZHRoPVxcLCBpbml0aWFsLXNjYWxlPTEuMFwiPlxyXG4gICAgPHRpdGxlPkhlYXJ0PC90aXRsZT5cclxuICAgIDxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj5cclxuICAgIGJvZHkge1xyXG4gICAgICAgIG1hcmdpbjogMDtcclxuICAgICAgICBwYWRkaW5nOiAwO1xyXG4gICAgICAgIGJhY2tncm91bmQ6IHdoaXRlO1xyXG4gICAgfVxyXG5cclxuICAgICNteUNhbnZhcyB7XHJcbiAgICAgICAgZGlzcGxheTogI2YwMDtcclxuICAgIH1cclxuICAgIDwvc3R5bGU+XHJcbjwvaGVhZD5cclxuXHJcbjxib2R5PlxyXG5cclxuICAgIDxjYW52YXMgd2lkdGg9XCIzOTNcIiBoZWlnaHQ9XCI1OTZcIiBpZD1cIm15TG92ZVwiPjwvY2FudmFzPlxyXG5cclxuICAgIDxzY3JpcHQ+XHJcbiAgICB3aW5kb3cucmVxdWVzdEFuaW1GcmFtZSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lXHJcbiAgICAgICAgfHwgd2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChjYWxsYmFjayxcclxuICAgICAgICAgICAgMTAwMCAvIDYwKTtcclxuICAgICAgICB9O1xyXG4gICAgfSkoKTtcclxuXHJcbiAgICB2YXIgRlggPSB7XHJcbiAgICAgICAgY29uZmlnOiB7XHJcbiAgICAgICAgYmFja2dyb3VuZDogJ3JnYmEoMjUwLDI1MCwyNTAsMC4yKScsXHJcbiAgICAgICAgY29sb3I6ICcjMDAwJyxcclxuICAgICAgICBoaWdobGlnaHQ6ICcjZjAwJyxcclxuXHJcbiAgICAgICAgfSxcclxuICAgICAgICBkb3RzOiBbXVxyXG4gICAgfTtcclxuICAgIEZYLmNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdteUxvdmUnKTtcclxuICAgIEZYLmN0eCA9IEZYLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gICAgLyogKkV4dGVuZCBNYXRoIE9iamVjdCAqL1xyXG4gICAgTWF0aC5UT19SQUQgPSBNYXRoLlBJIC8gMTgwO1xyXG4gICAgTWF0aC5nZXREaXN0YW5jZSA9IGZ1bmN0aW9uICh4MSwgeTEsIHgyLCB5Mikge1xyXG4gICAgICAgIHZhciB4cyA9IDAsIHlzID0gMDtcclxuICAgICAgICB4cyA9IHgxIC0geDI7XHJcbiAgICAgICAgeXMgPSB5MSAtIHkyO1xyXG4gICAgICAgIHhzID0geHMgKiB4cztcclxuICAgICAgICB5cyA9IHlzICogeXM7XHJcbiAgICAgICAgcmV0dXJuIE1hdGguc3FydCh4cyArIHlzKTtcclxuICAgIH07XHJcbiAgICBNYXRoLmdldERlZ3JlZSA9IGZ1bmN0aW9uICh4MSwgeTEsIHgyLCB5Mikge1xyXG4gICAgICAgIHZhciBkeCA9IHgyIC0geDEsIGR5ID0geTIgLSB5MTtcclxuICAgICAgICByZXR1cm4gTWF0aC5hdGFuMihkeSwgZHgpIC8gTWF0aC5UT19SQUQ7XHJcbiAgICB9O1xyXG4gICAgLyogKkRvdCBPYmplY3QgKi9cclxuICAgIHZhciBEb3QgPSBmdW5jdGlvbiAob3B0cykge1xyXG4gICAgICAgIHRoaXMuY29sb3IgPSBvcHRzLmNvbG9yO1xyXG4gICAgICAgIHRoaXMueCA9IDA7XHJcbiAgICAgICAgdGhpcy55ID0gMDtcclxuICAgICAgICB0aGlzLmRlc3RfeCA9IChvcHRzLmRlc3RfeCAtIDc1KTtcclxuICAgICAgICB0aGlzLmRlc3RfeSA9IChvcHRzLmRlc3RfeSAtIDc1KTtcclxuICAgIH07XHJcbiAgICBEb3QucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZCA9IHRoaXMsIGRpc3RfeCA9IGQuZGVzdF94IC0gZC54LCBkaXN0X3kgPSBkLmRlc3RfeSAtIGQueTtcclxuICAgICAgICBkLnggKz0gZGlzdF94ICogMC4wNTtcclxuICAgICAgICBkLnkgKz0gZGlzdF95ICogMC4wNTtcclxuICAgICAgICBGWC5jdHguZmlsbFN0eWxlID0gZC5jb2xvcjtcclxuICAgICAgICBGWC5jdHguZmlsbFJlY3QoZC54IC0gMiwgZC55IC0gMiwgNCwgNCk7XHJcbiAgICB9O1xyXG4gICAgLyogKmZ1bGwgc2NyZWVuIGNhbnZhcyAqL1xyXG4gICAgRlguc2V0RnVsbHNjcmVlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBGWC53aWR0aCA9IEZYLmNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgICAgIEZYLmhlaWdodCA9IEZYLmNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcbiAgICB9O1xyXG4gICAgLyogKk1vdXNlICovXHJcbiAgICBGWC5oYW5kbGVNb3VzZUV2ZW50ID0gZnVuY3Rpb24gKGUsIHBvd2VyKSB7XHJcbiAgICAgICAgdmFyIHJhZGl1cyA9IDc1LCBrID0gRlguZG90cy5sZW5ndGgsIGkgPSAwLCBteCwgbXksIGRpc3QsIGRlZ3JlZSwgZDtcclxuICAgICAgICBpZiAoZS5vZmZzZXRYKSB7XHJcbiAgICAgICAgbXggPSBlLm9mZnNldFg7XHJcbiAgICAgICAgbXkgPSBlLm9mZnNldFk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChlLmxheWVyWCkge1xyXG4gICAgICAgIG14ID0gZS5sYXllclg7XHJcbiAgICAgICAgbXkgPSBlLmxheWVyWTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbXggLT0gRlgud2lkdGggLyAyO1xyXG4gICAgICAgIG15IC09IEZYLmhlaWdodCAvIDI7XHJcbiAgICAgICAgZm9yICg7IGkgPCBrOyBpID0gaSArIDEpIHtcclxuICAgICAgICBkID0gRlguZG90c1tpXTtcclxuICAgICAgICBkaXN0ID0gTWF0aC5nZXREaXN0YW5jZShteCwgbXksIGQueCwgZC55KTtcclxuICAgICAgICBpZiAoZGlzdCA8IHJhZGl1cykge1xyXG4gICAgICAgICAgICBkZWdyZWUgPSBNYXRoLmdldERlZ3JlZShkLngsIGQueSwgbXgsIG15KTtcclxuICAgICAgICAgICAgZC54ICs9IChNYXRoLmNvcyhkZWdyZWUgKiBNYXRoLlRPX1JBRCkgKiAoKHJhZGl1cyAtIGRpc3QpICogcG93ZXIpKTtcclxuICAgICAgICAgICAgZC55ICs9IChNYXRoLnNpbihkZWdyZWUgKiBNYXRoLlRPX1JBRCkgKiAoKHJhZGl1cyAtIGRpc3QpICogcG93ZXIpKTtcclxuICAgICAgICAgICAgZC5jb2xvciA9IEZYLmNvbmZpZy5oaWdobGlnaHQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZC5jb2xvciA9IEZYLmNvbmZpZy5jb2xvcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qICpjcmVhdGUgdGhlIGhlYXJ0ICovXHJcbiAgICBGWC5jcmVhdGVIZWFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY29vcmRzID0gW1sxLCA0XSwgWzEsIDVdLCBbMSwgNl0sIFsxLCA3XSwgWzEsIDhdLCBbMiwgM10sIFsyLCA0XSwgWzIsIDVdLCBbMiwgNl0sIFsyLCA3XSwgWzIsIDhdLCBbMiwgOV0sIFszLCAyXSwgWzMsIDNdLCBbMywgNF0sIFszLCA1XSwgWzMsIDZdLCBbMywgN10sIFszLCA4XSwgWzMsIDldLCBbMywgMTBdLCBbNCwgMl0sIFs0LCAzXSwgWzQsIDRdLCBbNCwgNV0sIFs0LCA2XSwgWzQsIDddLCBbNCwgOF0sIFs0LCA5XSwgWzQsIDEwXSwgWzQsIDExXSwgWzUsIDJdLCBbNSwgM10sIFs1LCA0XSwgWzUsIDVdLCBbNSwgNl0sIFs1LCA3XSwgWzUsIDhdLCBbNSwgOV0sIFs1LCAxMF0sIFs1LCAxMV0sIFs2LCAyXSwgWzYsIDNdLCBbNiwgNF0sIFs2LCA1XSwgWzYsIDZdLCBbNiwgN10sIFs2LCA4XSwgWzYsIDldLCBbNiwgMTBdLCBbNiwgMTFdLCBbNiwgMTJdLCBbNywgM10sIFs3LCA0XSwgWzcsIDVdLCBbNywgNl0sIFs3LCA3XSwgWzcsIDhdLCBbNywgOV0sIFs3LCAxMF0sIFs3LCAxMV0sIFs3LCAxMl0sIFs4LCAzXSwgWzgsIDRdLCBbOCwgNV0sIFs4LCA2XSwgWzgsIDddLCBbOCwgOF0sIFs4LCA5XSwgWzgsIDEwXSwgWzgsIDExXSwgWzgsIDEyXSwgWzgsIDEzXSwgWzksIDJdLCBbOSwgM10sIFs5LCA0XSwgWzksIDVdLCBbOSwgNl0sIFs5LCA3XSwgWzksIDhdLCBbOSwgOV0sIFs5LCAxMF0sIFs5LCAxMV0sIFs5LCAxMl0sIFsxMCwgMl0sIFsxMCwgM10sIFsxMCwgNF0sIFsxMCwgNV0sIFsxMCwgNl0sIFsxMCwgN10sIFsxMCwgOF0sIFsxMCwgOV0sIFsxMCwgMTBdLCBbMTAsIDExXSwgWzExLCAyXSwgWzExLCAzXSwgWzExLCA0XSwgWzExLCA1XSwgWzExLCA2XSwgWzExLCA3XSwgWzExLCA4XSwgWzExLCA5XSwgWzExLCAxMF0sIFsxMSwgMTFdLCBbMTIsIDJdLCBbMTIsIDNdLCBbMTIsIDRdLCBbMTIsIDVdLCBbMTIsIDZdLCBbMTIsIDddLCBbMTIsIDhdLCBbMTIsIDldLCBbMTIsIDEwXSwgWzEzLCAzXSwgWzEzLCA0XSwgWzEzLCA1XSwgWzEzLCA2XSwgWzEzLCA3XSwgWzEzLCA4XSwgWzEzLCA5XSwgWzE0LCA0XSwgWzE0LCA1XSwgWzE0LCA2XSwgWzE0LCA3XSwgWzE0LCA4XV0sXHJcbiAgICAgICAgayA9IGNvb3Jkcy5sZW5ndGgsIHJhc3RlciA9IDEwLCBpID0gMDtcclxuICAgICAgICBmb3IgKDsgaSA8IGs7IGkgPSBpICsgMSkge1xyXG4gICAgICAgIEZYLmRvdHMucHVzaChuZXcgRG90KHtcclxuICAgICAgICAgICAgZGVzdF94OiBjb29yZHNbaV1bMF0gKiByYXN0ZXIsIGRlc3RfeTogY29vcmRzW2ldWzFdICogcmFzdGVyLCBjb2xvcjogRlguY29uZmlnLmNvbG9yXHJcbiAgICAgICAgfSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiAqbWFpbiBsb29wICovXHJcbiAgICBGWC5sb29wID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjdHggPSBGWC5jdHgsIGsgPSBGWC5kb3RzLmxlbmd0aCwgaSA9IDA7XHJcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IEZYLmNvbmZpZy5iYWNrZ3JvdW5kO1xyXG4gICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCBGWC53aWR0aCwgRlguaGVpZ2h0KTtcclxuICAgICAgICBjdHguc2F2ZSgpO1xyXG4gICAgICAgIGN0eC50cmFuc2xhdGUoRlgud2lkdGggLyAyLCBGWC5oZWlnaHQgLyAyKTtcclxuICAgICAgICBmb3IgKDsgaSA8IGs7IGkgPSBpICsgMSkge1xyXG4gICAgICAgIEZYLmRvdHNbaV0udXBkYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGN0eC5yZXN0b3JlKCk7XHJcbiAgICAgICAgcmVxdWVzdEFuaW1GcmFtZShGWC5sb29wKTtcclxuICAgIH07XHJcbiAgICAvKiAqRXZlbnQgYmluZGluZ3MgKi9cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBGWC5zZXRGdWxsc2NyZWVuKTtcclxuICAgIEZYLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIEZYLmhhbmRsZU1vdXNlRXZlbnQoZSwgLTAuMSk7XHJcbiAgICB9KTtcclxuICAgIEZYLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIEZYLmhhbmRsZU1vdXNlRXZlbnQoZSwgMSk7XHJcbiAgICB9KTtcclxuICAgIC8qICpJbml0ICovXHJcbiAgICBGWC5zZXRGdWxsc2NyZWVuKCk7XHJcbiAgICBGWC5jcmVhdGVIZWFydCgpO1xyXG4gICAgRlgubG9vcCgpOyBcclxuICAgIDwvc2NyaXB0PlxyXG5cclxuXHJcbjwvYm9keT5cclxuXHJcbjwvaHRtbD4ifSx7InF1ZXN0aW9uIjoiQ29kZSBoZWFydCAwMiIsImNvZGUiOiI8IURPQ1RZUEUgaHRtbD5cclxuPGh0bWwgbGFuZz1cImVuXCI+XHJcblxyXG48aGVhZD5cclxuICAgIDxtZXRhIGNoYXJzZXQ9XCJVVEYtOFwiPlxyXG4gICAgPG1ldGEgbmFtZT1cInZpZXdwb3J0XCIgY29udGVudD1cIndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjBcIj5cclxuICAgIDx0aXRsZT5IZWFydDE8L3RpdGxlPlxyXG4gICAgPHN0eWxlPlxyXG4gICAgICBjYW52YXMge1xyXG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICBsZWZ0OiAwO1xyXG4gICAgICAgIHRvcDogMDtcclxuICAgICAgICB3aWR0aDogMTAwJTtcclxuICAgICAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAuMik7XHJcbiAgICAgIH1cclxuPC9zdHlsZT5cclxuPC9oZWFkPlxyXG5cclxuPGJvZHk+XHJcblxyXG4gICAgPGNhbnZhcyBpZD1cImhlYXJ0XCIgd2lkdGg9XCIzOTNcIiBoZWlnaHQ9XCI1OTZcIj48L2NhbnZhcz5cclxuXHJcbiAgICA8c2NyaXB0PlxyXG4gICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lID1cclxuICAgICAgICB3aW5kb3cuX19yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XHJcbiAgICAgICAgd2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgICAgIHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgICAgICB3aW5kb3cub1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgICAgIHdpbmRvdy5tc1JlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgICAgIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNhbGxiYWNrLCBlbGVtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBsYXN0VGltZSA9IGVsZW1lbnQuX19sYXN0VGltZTtcclxuICAgICAgICAgICAgaWYgKGxhc3RUaW1lID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICBsYXN0VGltZSA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGN1cnJUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgdmFyIHRpbWVUb0NhbGwgPSBNYXRoLm1heCgxLCAzMyAtIChjdXJyVGltZSAtIGxhc3RUaW1lKSk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGNhbGxiYWNrLCB0aW1lVG9DYWxsKTtcclxuICAgICAgICAgICAgZWxlbWVudC5fX2xhc3RUaW1lID0gY3VyclRpbWUgKyB0aW1lVG9DYWxsO1xyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9KSgpO1xyXG4gICAgICB3aW5kb3cuaXNEZXZpY2UgPSAoL2FuZHJvaWR8d2Vib3N8aXBob25lfGlwYWR8aXBvZHxibGFja2JlcnJ5fGllbW9iaWxlfG9wZXJhIG1pbmkvaS50ZXN0KCgobmF2aWdhdG9yLnVzZXJBZ2VudCB8fCBuYXZpZ2F0b3IudmVuZG9yIHx8IHdpbmRvdy5vcGVyYSkpLnRvTG93ZXJDYXNlKCkpKTtcclxuICAgICAgdmFyIGxvYWRlZCA9IGZhbHNlO1xyXG4gICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAobG9hZGVkKSByZXR1cm47XHJcbiAgICAgICAgbG9hZGVkID0gdHJ1ZTtcclxuICAgICAgICB2YXIgbW9iaWxlID0gd2luZG93LmlzRGV2aWNlO1xyXG4gICAgICAgIHZhciBrb2VmID0gbW9iaWxlID8gMC41IDogMTtcclxuICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlYXJ0Jyk7XHJcbiAgICAgICAgdmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gICAgICAgIHZhciB3aWR0aCA9IGNhbnZhcy53aWR0aCA9IGtvZWYgKiBpbm5lcldpZHRoO1xyXG4gICAgICAgIHZhciBoZWlnaHQgPSBjYW52YXMuaGVpZ2h0ID0ga29lZiAqIGlubmVySGVpZ2h0O1xyXG4gICAgICAgIHZhciByYW5kID0gTWF0aC5yYW5kb207XHJcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwicmdiYSgwLDAsMCwxKVwiO1xyXG4gICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICBjdHguZm9udCA9IFwiMzBweCBBcmlhbFwiO1xyXG4gICAgICAgIGN0eC5maWxsVGV4dChcIlR1YW5cIiwgMTAsIDUwKTtcclxuICAgICAgICB2YXIgaGVhcnRQb3NpdGlvbiA9IGZ1bmN0aW9uIChyYWQpIHtcclxuICAgICAgICAgIC8vcmV0dXJuIFtNYXRoLnNpbihyYWQpLCBNYXRoLmNvcyhyYWQpXTtcclxuICAgICAgICAgIHJldHVybiBbTWF0aC5wb3coTWF0aC5zaW4ocmFkKSwgMyksIC0oMTUgKiBNYXRoLmNvcyhyYWQpIC0gNSAqIE1hdGguY29zKDIgKiByYWQpIC0gMiAqIE1hdGguY29zKDMgKiByYWQpIC0gTWF0aC5jb3MoNCAqIHJhZCkpXTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBzY2FsZUFuZFRyYW5zbGF0ZSA9IGZ1bmN0aW9uIChwb3MsIHN4LCBzeSwgZHgsIGR5KSB7XHJcbiAgICAgICAgICByZXR1cm4gW2R4ICsgcG9zWzBdICogc3gsIGR5ICsgcG9zWzFdICogc3ldO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIHdpZHRoID0gY2FudmFzLndpZHRoID0ga29lZiAqIGlubmVyV2lkdGg7XHJcbiAgICAgICAgICBoZWlnaHQgPSBjYW52YXMuaGVpZ2h0ID0ga29lZiAqIGlubmVySGVpZ2h0O1xyXG4gICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwicmdiYSgwLDAsMCwxKVwiO1xyXG4gICAgICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciB0cmFjZUNvdW50ID0gbW9iaWxlID8gMjAgOiA1MDtcclxuICAgICAgICB2YXIgcG9pbnRzT3JpZ2luID0gW107XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgdmFyIGRyID0gbW9iaWxlID8gMC4zIDogMC4xO1xyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBNYXRoLlBJICogMjsgaSArPSBkcikgcG9pbnRzT3JpZ2luLnB1c2goc2NhbGVBbmRUcmFuc2xhdGUoaGVhcnRQb3NpdGlvbihpKSwgMjEwLCAxMywgMCwgMCkpO1xyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBNYXRoLlBJICogMjsgaSArPSBkcikgcG9pbnRzT3JpZ2luLnB1c2goc2NhbGVBbmRUcmFuc2xhdGUoaGVhcnRQb3NpdGlvbihpKSwgMTUwLCA5LCAwLCAwKSk7XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IE1hdGguUEkgKiAyOyBpICs9IGRyKSBwb2ludHNPcmlnaW4ucHVzaChzY2FsZUFuZFRyYW5zbGF0ZShoZWFydFBvc2l0aW9uKGkpLCA5MCwgNSwgMCwgMCkpO1xyXG4gICAgICAgIHZhciBoZWFydFBvaW50c0NvdW50ID0gcG9pbnRzT3JpZ2luLmxlbmd0aDtcclxuICAgICAgICB2YXIgdGFyZ2V0UG9pbnRzID0gW107XHJcbiAgICAgICAgdmFyIHB1bHNlID0gZnVuY3Rpb24gKGt4LCBreSkge1xyXG4gICAgICAgICAgZm9yIChpID0gMDsgaSA8IHBvaW50c09yaWdpbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0YXJnZXRQb2ludHNbaV0gPSBbXTtcclxuICAgICAgICAgICAgdGFyZ2V0UG9pbnRzW2ldWzBdID0ga3ggKiBwb2ludHNPcmlnaW5baV1bMF0gKyB3aWR0aCAvIDI7XHJcbiAgICAgICAgICAgIHRhcmdldFBvaW50c1tpXVsxXSA9IGt5ICogcG9pbnRzT3JpZ2luW2ldWzFdICsgaGVpZ2h0IC8gMjtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBlID0gW107XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGhlYXJ0UG9pbnRzQ291bnQ7IGkrKykge1xyXG4gICAgICAgICAgdmFyIHggPSByYW5kKCkgKiB3aWR0aDtcclxuICAgICAgICAgIHZhciB5ID0gcmFuZCgpICogaGVpZ2h0O1xyXG4gICAgICAgICAgZVtpXSA9IHtcclxuICAgICAgICAgICAgdng6IDAsXHJcbiAgICAgICAgICAgIHZ5OiAwLFxyXG4gICAgICAgICAgICBSOiAyLFxyXG4gICAgICAgICAgICBzcGVlZDogcmFuZCgpICsgNSxcclxuICAgICAgICAgICAgcTogfn4ocmFuZCgpICogaGVhcnRQb2ludHNDb3VudCksXHJcbiAgICAgICAgICAgIEQ6IDIgKiAoaSAlIDIpIC0gMSxcclxuICAgICAgICAgICAgZm9yY2U6IDAuMiAqIHJhbmQoKSArIDAuNyxcclxuICAgICAgICAgICAgZjogXCJoc2xhKDAsXCIgKyB+fig0MCAqIHJhbmQoKSArIDYwKSArIFwiJSxcIiArIH5+KDYwICogcmFuZCgpICsgMjApICsgXCIlLC4zKVwiLFxyXG4gICAgICAgICAgICAvL2Y6IFwicmdiKDI1MCwgMTE3LCAxMzUpXCIsXHJcbiAgICAgICAgICAgIHRyYWNlOiBbXVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgdHJhY2VDb3VudDsgaysrKSBlW2ldLnRyYWNlW2tdID0ge1xyXG4gICAgICAgICAgICB4OiB4LFxyXG4gICAgICAgICAgICB5OiB5XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY29uZmlnID0ge1xyXG4gICAgICAgICAgdHJhY2VLOiAwLjQsXHJcbiAgICAgICAgICAvLyB0aW1lRGVsdGE6IDAuMDFcclxuICAgICAgICAgIHRpbWVEZWx0YTogMC42XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgdGltZSA9IDA7XHJcbiAgICAgICAgdmFyIGxvb3AgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICB2YXIgbiA9IC1NYXRoLmNvcyh0aW1lKTtcclxuICAgICAgICAgIHB1bHNlKCgxICsgbikgKiAuNSwgKDEgKyBuKSAqIC41KTtcclxuICAgICAgICAgIHRpbWUgKz0gKChNYXRoLnNpbih0aW1lKSkgPCAwID8gOSA6IChuID4gMC44KSA/IC4yIDogMSkgKiBjb25maWcudGltZURlbHRhO1xyXG4gICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwicmdiYSgwLDAsMCwuMSlcIjtcclxuICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgIGZvciAoaSA9IGUubGVuZ3RoOyBpLS07KSB7XHJcbiAgICAgICAgICAgIHZhciB1ID0gZVtpXTtcclxuICAgICAgICAgICAgdmFyIHEgPSB0YXJnZXRQb2ludHNbdS5xXTtcclxuICAgICAgICAgICAgdmFyIGR4ID0gdS50cmFjZVswXS54IC0gcVswXTtcclxuICAgICAgICAgICAgdmFyIGR5ID0gdS50cmFjZVswXS55IC0gcVsxXTtcclxuICAgICAgICAgICAgdmFyIGxlbmd0aCA9IE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSk7XHJcbiAgICAgICAgICAgIGlmICgxMCA+IGxlbmd0aCkge1xyXG4gICAgICAgICAgICAgIGlmICgwLjk1IDwgcmFuZCgpKSB7XHJcbiAgICAgICAgICAgICAgICB1LnEgPSB+fihyYW5kKCkgKiBoZWFydFBvaW50c0NvdW50KTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKDAuOTkgPCByYW5kKCkpIHtcclxuICAgICAgICAgICAgICAgICAgdS5EICo9IC0xO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdS5xICs9IHUuRDtcclxuICAgICAgICAgICAgICAgIHUucSAlPSBoZWFydFBvaW50c0NvdW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgPiB1LnEpIHtcclxuICAgICAgICAgICAgICAgICAgdS5xICs9IGhlYXJ0UG9pbnRzQ291bnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHUudnggKz0gLWR4IC8gbGVuZ3RoICogdS5zcGVlZDtcclxuICAgICAgICAgICAgdS52eSArPSAtZHkgLyBsZW5ndGggKiB1LnNwZWVkO1xyXG4gICAgICAgICAgICB1LnRyYWNlWzBdLnggKz0gdS52eDtcclxuICAgICAgICAgICAgdS50cmFjZVswXS55ICs9IHUudnk7XHJcbiAgICAgICAgICAgIHUudnggKj0gdS5mb3JjZTtcclxuICAgICAgICAgICAgdS52eSAqPSB1LmZvcmNlO1xyXG4gICAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgdS50cmFjZS5sZW5ndGggLSAxOykge1xyXG4gICAgICAgICAgICAgIHZhciBUID0gdS50cmFjZVtrXTtcclxuICAgICAgICAgICAgICB2YXIgTiA9IHUudHJhY2VbKytrXTtcclxuICAgICAgICAgICAgICBOLnggLT0gY29uZmlnLnRyYWNlSyAqIChOLnggLSBULngpO1xyXG4gICAgICAgICAgICAgIE4ueSAtPSBjb25maWcudHJhY2VLICogKE4ueSAtIFQueSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHUuZjtcclxuICAgICAgICAgICAgZm9yIChrID0gMDsgayA8IHUudHJhY2UubGVuZ3RoOyBrKyspIHtcclxuICAgICAgICAgICAgICBjdHguZmlsbFJlY3QodS50cmFjZVtrXS54LCB1LnRyYWNlW2tdLnksIDEsIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wLCBjYW52YXMpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgbG9vcCgpO1xyXG4gICAgICB9O1xyXG4gICAgICB2YXIgcyA9IGRvY3VtZW50LnJlYWR5U3RhdGU7XHJcbiAgICAgIGlmIChzID09PSAnY29tcGxldGUnIHx8IHMgPT09ICdsb2FkZWQnIHx8IHMgPT09ICdpbnRlcmFjdGl2ZScpIGluaXQoKTtcclxuICAgICAgZWxzZSBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdCwgZmFsc2UpO1xyXG4gICAgPC9zY3JpcHQ+XHJcblxyXG48L2JvZHk+XHJcblxyXG48L2h0bWw+In0seyJxdWVzdGlvbiI6IkNvZGUgaGVhcnQgMDMiLCJjb2RlIjoiPCFET0NUWVBFIGh0bWw+XHJcbjxodG1sIGxhbmc9XCJlblwiPlxyXG5cclxuPGhlYWQ+XHJcbiAgICA8bWV0YSBjaGFyc2V0PVwiVVRGLThcIj5cclxuICAgIDxtZXRhIG5hbWU9XCJ2aWV3cG9ydFwiIGNvbnRlbnQ9XCJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wXCI+XHJcbiAgICA8dGl0bGU+SGVhcnQyPC90aXRsZT5cclxuICAgIDxzdHlsZT5cclxuICAgICAgICBjYW52YXMge1xyXG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICAgICAgICAgIGxlZnQ6IDA7XHJcbiAgICAgICAgICAgIHRvcDogMDtcclxuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgICAgICAgIGhlaWdodDogMTAwJTtcclxuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAuMik7XHJcbiAgICAgICAgfVxyXG4gICAgPC9zdHlsZT5cclxuPC9oZWFkPlxyXG5cclxuPGJvZHk+XHJcblxyXG4gICAgPGNhbnZhcyBpZD1cImhlYXJ0XCIgd2lkdGg9XCIzOTNcIiBoZWlnaHQ9XCI1OTZcIj48L2NhbnZhcz5cclxuXHJcbiAgICA8c2NyaXB0PlxyXG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPVxyXG4gICAgICAgICAgICB3aW5kb3cuX19yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgICAgICAgICB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XHJcbiAgICAgICAgICAgIHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgICAgICAgICAgd2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgICAgICAgICAgd2luZG93Lm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XHJcbiAgICAgICAgICAgIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNhbGxiYWNrLCBlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RUaW1lID0gZWxlbWVudC5fX2xhc3RUaW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsYXN0VGltZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RUaW1lID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGltZVRvQ2FsbCA9IE1hdGgubWF4KDEsIDMzIC0gKGN1cnJUaW1lIC0gbGFzdFRpbWUpKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChjYWxsYmFjaywgdGltZVRvQ2FsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5fX2xhc3RUaW1lID0gY3VyclRpbWUgKyB0aW1lVG9DYWxsO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSkoKTtcclxuICAgICAgICB3aW5kb3cuaXNEZXZpY2UgPSAoL2FuZHJvaWR8d2Vib3N8aXBob25lfGlwYWR8aXBvZHxibGFja2JlcnJ5fGllbW9iaWxlfG9wZXJhIG1pbmkvaS50ZXN0KCgobmF2aWdhdG9yLnVzZXJBZ2VudCB8fCBuYXZpZ2F0b3IudmVuZG9yIHx8IHdpbmRvdy5vcGVyYSkpLnRvTG93ZXJDYXNlKCkpKTtcclxuICAgICAgICB2YXIgbG9hZGVkID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChsb2FkZWQpIHJldHVybjtcclxuICAgICAgICAgICAgbG9hZGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgdmFyIG1vYmlsZSA9IHdpbmRvdy5pc0RldmljZTtcclxuICAgICAgICAgICAgdmFyIGtvZWYgPSBtb2JpbGUgPyAwLjUgOiAxO1xyXG4gICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlYXJ0Jyk7XHJcbiAgICAgICAgICAgIHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICAgICAgdmFyIHdpZHRoID0gY2FudmFzLndpZHRoID0ga29lZiAqIGlubmVyV2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBoZWlnaHQgPSBjYW52YXMuaGVpZ2h0ID0ga29lZiAqIGlubmVySGVpZ2h0O1xyXG4gICAgICAgICAgICB2YXIgcmFuZCA9IE1hdGgucmFuZG9tO1xyXG4gICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gXCJyZ2JhKDAsMCwwLDEpXCI7XHJcbiAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgICAgIHZhciBoZWFydFBvc2l0aW9uID0gZnVuY3Rpb24gKHJhZCkge1xyXG4gICAgICAgICAgICAgICAgLy9yZXR1cm4gW01hdGguc2luKHJhZCksIE1hdGguY29zKHJhZCldO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtNYXRoLnBvdyhNYXRoLnNpbihyYWQpLCAzKSwgLSgxNSAqIE1hdGguY29zKHJhZCkgLSA1ICogTWF0aC5jb3MoMiAqIHJhZCkgLSAyICogTWF0aC5jb3MoMyAqIHJhZCkgLSBNYXRoLmNvcyg0ICogcmFkKSldO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgc2NhbGVBbmRUcmFuc2xhdGUgPSBmdW5jdGlvbiAocG9zLCBzeCwgc3ksIGR4LCBkeSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtkeCArIHBvc1swXSAqIHN4LCBkeSArIHBvc1sxXSAqIHN5XTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aCA9IGNhbnZhcy53aWR0aCA9IGtvZWYgKiBpbm5lcldpZHRoO1xyXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gY2FudmFzLmhlaWdodCA9IGtvZWYgKiBpbm5lckhlaWdodDtcclxuICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBcInJnYmEoMCwwLDAsMSlcIjtcclxuICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgdHJhY2VDb3VudCA9IG1vYmlsZSA/IDIwIDogNTA7XHJcbiAgICAgICAgICAgIHZhciBwb2ludHNPcmlnaW4gPSBbXTtcclxuICAgICAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgICAgIHZhciBkciA9IG1vYmlsZSA/IDAuMyA6IDAuMTtcclxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IE1hdGguUEkgKiAyOyBpICs9IGRyKSBwb2ludHNPcmlnaW4ucHVzaChzY2FsZUFuZFRyYW5zbGF0ZShoZWFydFBvc2l0aW9uKGkpLCAyMTAsIDEzLCAwLCAwKSk7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBNYXRoLlBJICogMjsgaSArPSBkcikgcG9pbnRzT3JpZ2luLnB1c2goc2NhbGVBbmRUcmFuc2xhdGUoaGVhcnRQb3NpdGlvbihpKSwgMTUwLCA5LCAwLCAwKSk7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBNYXRoLlBJICogMjsgaSArPSBkcikgcG9pbnRzT3JpZ2luLnB1c2goc2NhbGVBbmRUcmFuc2xhdGUoaGVhcnRQb3NpdGlvbihpKSwgOTAsIDUsIDAsIDApKTtcclxuICAgICAgICAgICAgdmFyIGhlYXJ0UG9pbnRzQ291bnQgPSBwb2ludHNPcmlnaW4ubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgdmFyIHRhcmdldFBvaW50cyA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgcHVsc2UgPSBmdW5jdGlvbiAoa3gsIGt5KSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcG9pbnRzT3JpZ2luLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UG9pbnRzW2ldID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UG9pbnRzW2ldWzBdID0ga3ggKiBwb2ludHNPcmlnaW5baV1bMF0gKyB3aWR0aCAvIDI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UG9pbnRzW2ldWzFdID0ga3kgKiBwb2ludHNPcmlnaW5baV1bMV0gKyBoZWlnaHQgLyAyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdmFyIGUgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGhlYXJ0UG9pbnRzQ291bnQ7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHggPSByYW5kKCkgKiB3aWR0aDtcclxuICAgICAgICAgICAgICAgIHZhciB5ID0gcmFuZCgpICogaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgZVtpXSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB2eDogMCxcclxuICAgICAgICAgICAgICAgICAgICB2eTogMCxcclxuICAgICAgICAgICAgICAgICAgICBSOiAyLFxyXG4gICAgICAgICAgICAgICAgICAgIHNwZWVkOiByYW5kKCkgKyA1LFxyXG4gICAgICAgICAgICAgICAgICAgIHE6IH5+KHJhbmQoKSAqIGhlYXJ0UG9pbnRzQ291bnQpLFxyXG4gICAgICAgICAgICAgICAgICAgIEQ6IDIgKiAoaSAlIDIpIC0gMSxcclxuICAgICAgICAgICAgICAgICAgICBmb3JjZTogMC4yICogcmFuZCgpICsgMC43LFxyXG4gICAgICAgICAgICAgICAgICAgIGY6IFwiaHNsYSgwLFwiICsgfn4oNDAgKiByYW5kKCkgKyA2MCkgKyBcIiUsXCIgKyB+fig2MCAqIHJhbmQoKSArIDIwKSArIFwiJSwuMylcIixcclxuICAgICAgICAgICAgICAgICAgICB0cmFjZTogW11cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHRyYWNlQ291bnQ7IGsrKykgZVtpXS50cmFjZVtrXSA9IHsgeDogeCwgeTogeSB9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgY29uZmlnID0ge1xyXG4gICAgICAgICAgICAgICAgdHJhY2VLOiAwLjQsXHJcbiAgICAgICAgICAgICAgICB0aW1lRGVsdGE6IDAuMDFcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHZhciB0aW1lID0gMDtcclxuICAgICAgICAgICAgdmFyIGxvb3AgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbiA9IC1NYXRoLmNvcyh0aW1lKTtcclxuICAgICAgICAgICAgICAgIHB1bHNlKCgxICsgbikgKiAuNSwgKDEgKyBuKSAqIC41KTtcclxuICAgICAgICAgICAgICAgIHRpbWUgKz0gKChNYXRoLnNpbih0aW1lKSkgPCAwID8gOSA6IChuID4gMC44KSA/IC4yIDogMSkgKiBjb25maWcudGltZURlbHRhO1xyXG4gICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwicmdiYSgwLDAsMCwuMSlcIjtcclxuICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIGZvciAoaSA9IGUubGVuZ3RoOyBpLS07KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHUgPSBlW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBxID0gdGFyZ2V0UG9pbnRzW3UucV07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGR4ID0gdS50cmFjZVswXS54IC0gcVswXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZHkgPSB1LnRyYWNlWzBdLnkgLSBxWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSBNYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgxMCA+IGxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoMC45NSA8IHJhbmQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdS5xID0gfn4ocmFuZCgpICogaGVhcnRQb2ludHNDb3VudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMC45OSA8IHJhbmQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUuRCAqPSAtMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUucSArPSB1LkQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1LnEgJT0gaGVhcnRQb2ludHNDb3VudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID4gdS5xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdS5xICs9IGhlYXJ0UG9pbnRzQ291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdS52eCArPSAtZHggLyBsZW5ndGggKiB1LnNwZWVkO1xyXG4gICAgICAgICAgICAgICAgICAgIHUudnkgKz0gLWR5IC8gbGVuZ3RoICogdS5zcGVlZDtcclxuICAgICAgICAgICAgICAgICAgICB1LnRyYWNlWzBdLnggKz0gdS52eDtcclxuICAgICAgICAgICAgICAgICAgICB1LnRyYWNlWzBdLnkgKz0gdS52eTtcclxuICAgICAgICAgICAgICAgICAgICB1LnZ4ICo9IHUuZm9yY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdS52eSAqPSB1LmZvcmNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCB1LnRyYWNlLmxlbmd0aCAtIDE7KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBUID0gdS50cmFjZVtrXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIE4gPSB1LnRyYWNlWysra107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE4ueCAtPSBjb25maWcudHJhY2VLICogKE4ueCAtIFQueCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE4ueSAtPSBjb25maWcudHJhY2VLICogKE4ueSAtIFQueSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSB1LmY7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gMDsgayA8IHUudHJhY2UubGVuZ3RoOyBrKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KHUudHJhY2Vba10ueCwgdS50cmFjZVtrXS55LCAxLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3AsIGNhbnZhcyk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGxvb3AoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcyA9IGRvY3VtZW50LnJlYWR5U3RhdGU7XHJcbiAgICAgICAgaWYgKHMgPT09ICdjb21wbGV0ZScgfHwgcyA9PT0gJ2xvYWRlZCcgfHwgcyA9PT0gJ2ludGVyYWN0aXZlJykgaW5pdCgpO1xyXG4gICAgICAgIGVsc2UgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXQsIGZhbHNlKTtcclxuICAgIDwvc2NyaXB0PlxyXG5cclxuPC9ib2R5PlxyXG5cclxuPC9odG1sPiJ9LHsicXVlc3Rpb24iOiJDb2RlIGhlYXQgMDQiLCJjb2RlIjoiPCFET0NUWVBFIGh0bWw+XHJcbjxodG1sIGxhbmc9XCJlblwiPlxyXG5cclxuPGhlYWQ+XHJcbiAgICA8bWV0YSBjaGFyc2V0PVwiVVRGLThcIj5cclxuICAgIDxtZXRhIG5hbWU9XCJ2aWV3cG9ydFwiIGNvbnRlbnQ9XCJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wXCI+XHJcbiAgICA8dGl0bGU+SGFlcnQzPC90aXRsZT5cclxuICAgIDxzdHlsZT5cclxuICAgICAgICBjYW52YXMge1xyXG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICAgICAgICAgIGxlZnQ6IDA7XHJcbiAgICAgICAgICAgIHRvcDogMDtcclxuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgICAgICAgIGhlaWdodDogMTAwJTtcclxuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAuMik7XHJcbiAgICAgICAgfVxyXG4gICAgPC9zdHlsZT5cclxuPC9oZWFkPlxyXG5cclxuPGJvZHk+XHJcblxyXG4gICAgPGNhbnZhcyBpZD1cImhlYXJ0XCIgd2lkdGg9XCIzOTNcIiBoZWlnaHQ9XCI1OTZcIj48L2NhbnZhcz5cclxuXHJcbiAgICA8c2NyaXB0PlxyXG4gICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPVxyXG4gICAgICAgICAgICB3aW5kb3cuX19yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxyXG4gICAgICAgICAgICB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XHJcbiAgICAgICAgICAgIHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgICAgICAgICAgd2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcclxuICAgICAgICAgICAgd2luZG93Lm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XHJcbiAgICAgICAgICAgIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNhbGxiYWNrLCBlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RUaW1lID0gZWxlbWVudC5fX2xhc3RUaW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsYXN0VGltZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RUaW1lID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGltZVRvQ2FsbCA9IE1hdGgubWF4KDEsIDMzIC0gKGN1cnJUaW1lIC0gbGFzdFRpbWUpKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChjYWxsYmFjaywgdGltZVRvQ2FsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5fX2xhc3RUaW1lID0gY3VyclRpbWUgKyB0aW1lVG9DYWxsO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSkoKTtcclxuICAgICAgICB3aW5kb3cuaXNEZXZpY2UgPSAoL2FuZHJvaWR8d2Vib3N8aXBob25lfGlwYWR8aXBvZHxibGFja2JlcnJ5fGllbW9iaWxlfG9wZXJhIG1pbmkvaS50ZXN0KCgobmF2aWdhdG9yLnVzZXJBZ2VudCB8fCBuYXZpZ2F0b3IudmVuZG9yIHx8IHdpbmRvdy5vcGVyYSkpLnRvTG93ZXJDYXNlKCkpKTtcclxuICAgICAgICB2YXIgbG9hZGVkID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChsb2FkZWQpIHJldHVybjtcclxuICAgICAgICAgICAgbG9hZGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgdmFyIG1vYmlsZSA9IHdpbmRvdy5pc0RldmljZTtcclxuICAgICAgICAgICAgdmFyIGtvZWYgPSBtb2JpbGUgPyAwLjUgOiAxO1xyXG4gICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlYXJ0Jyk7XHJcbiAgICAgICAgICAgIHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICAgICAgdmFyIHdpZHRoID0gY2FudmFzLndpZHRoID0ga29lZiAqIGlubmVyV2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBoZWlnaHQgPSBjYW52YXMuaGVpZ2h0ID0ga29lZiAqIGlubmVySGVpZ2h0O1xyXG4gICAgICAgICAgICB2YXIgcmFuZCA9IE1hdGgucmFuZG9tO1xyXG4gICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gXCJyZ2JhKDAsMCwwLDEpXCI7XHJcbiAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuXHJcbiAgICAgICAgICAgIHZhciBoZWFydFBvc2l0aW9uID0gZnVuY3Rpb24gKHJhZCkge1xyXG4gICAgICAgICAgICAgICAgLy9yZXR1cm4gW01hdGguc2luKHJhZCksIE1hdGguY29zKHJhZCldO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtNYXRoLnBvdyhNYXRoLnNpbihyYWQpLCAzKSwgLSgxNSAqIE1hdGguY29zKHJhZCkgLSA1ICogTWF0aC5jb3MoMiAqIHJhZCkgLSAyICogTWF0aC5jb3MoMyAqIHJhZCkgLSBNYXRoLmNvcyg0ICogcmFkKSldO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgc2NhbGVBbmRUcmFuc2xhdGUgPSBmdW5jdGlvbiAocG9zLCBzeCwgc3ksIGR4LCBkeSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtkeCArIHBvc1swXSAqIHN4LCBkeSArIHBvc1sxXSAqIHN5XTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB3aWR0aCA9IGNhbnZhcy53aWR0aCA9IGtvZWYgKiBpbm5lcldpZHRoO1xyXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gY2FudmFzLmhlaWdodCA9IGtvZWYgKiBpbm5lckhlaWdodDtcclxuICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBcInJnYmEoMCwwLDAsMSlcIjtcclxuICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgdHJhY2VDb3VudCA9IG1vYmlsZSA/IDIwIDogNTA7XHJcbiAgICAgICAgICAgIHZhciBwb2ludHNPcmlnaW4gPSBbXTtcclxuICAgICAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgICAgIHZhciBkciA9IG1vYmlsZSA/IDAuMyA6IDAuMTtcclxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IE1hdGguUEkgKiAyOyBpICs9IGRyKSBwb2ludHNPcmlnaW4ucHVzaChzY2FsZUFuZFRyYW5zbGF0ZShoZWFydFBvc2l0aW9uKGkpLCAyMTAsIDEzLCAwLCAwKSk7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBNYXRoLlBJICogMjsgaSArPSBkcikgcG9pbnRzT3JpZ2luLnB1c2goc2NhbGVBbmRUcmFuc2xhdGUoaGVhcnRQb3NpdGlvbihpKSwgMTUwLCA5LCAwLCAwKSk7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBNYXRoLlBJICogMjsgaSArPSBkcikgcG9pbnRzT3JpZ2luLnB1c2goc2NhbGVBbmRUcmFuc2xhdGUoaGVhcnRQb3NpdGlvbihpKSwgOTAsIDUsIDAsIDApKTtcclxuICAgICAgICAgICAgdmFyIGhlYXJ0UG9pbnRzQ291bnQgPSBwb2ludHNPcmlnaW4ubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgdmFyIHRhcmdldFBvaW50cyA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgcHVsc2UgPSBmdW5jdGlvbiAoa3gsIGt5KSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcG9pbnRzT3JpZ2luLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UG9pbnRzW2ldID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UG9pbnRzW2ldWzBdID0ga3ggKiBwb2ludHNPcmlnaW5baV1bMF0gKyB3aWR0aCAvIDI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UG9pbnRzW2ldWzFdID0ga3kgKiBwb2ludHNPcmlnaW5baV1bMV0gKyBoZWlnaHQgLyAyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdmFyIGUgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGhlYXJ0UG9pbnRzQ291bnQ7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHggPSByYW5kKCkgKiB3aWR0aDtcclxuICAgICAgICAgICAgICAgIHZhciB5ID0gcmFuZCgpICogaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgZVtpXSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB2eDogMCxcclxuICAgICAgICAgICAgICAgICAgICB2eTogMCxcclxuICAgICAgICAgICAgICAgICAgICBSOiAyLFxyXG4gICAgICAgICAgICAgICAgICAgIHNwZWVkOiByYW5kKCkgKyA1LFxyXG4gICAgICAgICAgICAgICAgICAgIHE6IH5+KHJhbmQoKSAqIGhlYXJ0UG9pbnRzQ291bnQpLFxyXG4gICAgICAgICAgICAgICAgICAgIEQ6IDIgKiAoaSAlIDIpIC0gMSxcclxuICAgICAgICAgICAgICAgICAgICBmb3JjZTogMC4yICogcmFuZCgpICsgMC43LFxyXG4gICAgICAgICAgICAgICAgICAgIGY6IFwiaHNsYSgwLFwiICsgfn4oNDAgKiByYW5kKCkgKyA2MCkgKyBcIiUsXCIgKyB+fig2MCAqIHJhbmQoKSArIDIwKSArIFwiJSwuMylcIixcclxuICAgICAgICAgICAgICAgICAgICB0cmFjZTogW11cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHRyYWNlQ291bnQ7IGsrKykgZVtpXS50cmFjZVtrXSA9IHsgeDogeCwgeTogeSB9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgY29uZmlnID0ge1xyXG4gICAgICAgICAgICAgICAgdHJhY2VLOiAwLjQsXHJcbiAgICAgICAgICAgICAgICB0aW1lRGVsdGE6IDAuMDFcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHZhciB0aW1lID0gMDtcclxuICAgICAgICAgICAgdmFyIGxvb3AgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbiA9IC1NYXRoLmNvcyh0aW1lKTtcclxuICAgICAgICAgICAgICAgIHB1bHNlKCgxICsgbikgKiAuNSwgKDEgKyBuKSAqIC41KTtcclxuICAgICAgICAgICAgICAgIHRpbWUgKz0gKChNYXRoLnNpbih0aW1lKSkgPCAwID8gOSA6IChuID4gMC44KSA/IC4yIDogMSkgKiBjb25maWcudGltZURlbHRhO1xyXG4gICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwicmdiYSgwLDAsMCwuMSlcIjtcclxuICAgICAgICAgICAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIGZvciAoaSA9IGUubGVuZ3RoOyBpLS07KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHUgPSBlW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBxID0gdGFyZ2V0UG9pbnRzW3UucV07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGR4ID0gdS50cmFjZVswXS54IC0gcVswXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZHkgPSB1LnRyYWNlWzBdLnkgLSBxWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSBNYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgxMCA+IGxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoMC45NSA8IHJhbmQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdS5xID0gfn4ocmFuZCgpICogaGVhcnRQb2ludHNDb3VudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMC45OSA8IHJhbmQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUuRCAqPSAtMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUucSArPSB1LkQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1LnEgJT0gaGVhcnRQb2ludHNDb3VudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID4gdS5xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdS5xICs9IGhlYXJ0UG9pbnRzQ291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdS52eCArPSAtZHggLyBsZW5ndGggKiB1LnNwZWVkO1xyXG4gICAgICAgICAgICAgICAgICAgIHUudnkgKz0gLWR5IC8gbGVuZ3RoICogdS5zcGVlZDtcclxuICAgICAgICAgICAgICAgICAgICB1LnRyYWNlWzBdLnggKz0gdS52eDtcclxuICAgICAgICAgICAgICAgICAgICB1LnRyYWNlWzBdLnkgKz0gdS52eTtcclxuICAgICAgICAgICAgICAgICAgICB1LnZ4ICo9IHUuZm9yY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdS52eSAqPSB1LmZvcmNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCB1LnRyYWNlLmxlbmd0aCAtIDE7KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBUID0gdS50cmFjZVtrXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIE4gPSB1LnRyYWNlWysra107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE4ueCAtPSBjb25maWcudHJhY2VLICogKE4ueCAtIFQueCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE4ueSAtPSBjb25maWcudHJhY2VLICogKE4ueSAtIFQueSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSB1LmY7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gMDsgayA8IHUudHJhY2UubGVuZ3RoOyBrKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmZpbGxSZWN0KHUudHJhY2Vba10ueCwgdS50cmFjZVtrXS55LCAxLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gXCJyZ2JhKDI1NSwyNTUsMjU1LDEpXCI7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSB1LnRyYWNlLmxlbmd0aCArIDEzOyBpLS07KSBjdHguZmlsbFJlY3QodGFyZ2V0UG9pbnRzW2ldWzBdLCB0YXJnZXRQb2ludHNbaV1bMV0sIDIsIDIpO1xyXG5cclxuICAgICAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCwgY2FudmFzKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgbG9vcCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBzID0gZG9jdW1lbnQucmVhZHlTdGF0ZTtcclxuICAgICAgICBpZiAocyA9PT0gJ2NvbXBsZXRlJyB8fCBzID09PSAnbG9hZGVkJyB8fCBzID09PSAnaW50ZXJhY3RpdmUnKSBpbml0KCk7XHJcbiAgICAgICAgZWxzZSBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdCwgZmFsc2UpO1xyXG4gICAgPC9zY3JpcHQ+XHJcblxyXG48L2JvZHk+XHJcblxyXG48L2h0bWw+In0seyJxdWVzdGlvbiI6IkNvZGUgaGVhcnQgMDUiLCJjb2RlIjoiPCFET0NUWVBFIGh0bWw+XHJcbjxodG1sIGxhbmc9XCJlblwiPlxyXG5cclxuPGhlYWQ+XHJcbiAgICA8bWV0YSBjaGFyc2V0PVwiVVRGLThcIj5cclxuICAgIDxtZXRhIG5hbWU9XCJ2aWV3cG9ydFwiIGNvbnRlbnQ9XCJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wXCI+XHJcbiAgICA8dGl0bGU+Q29kZSBIZWFydCAwNTwvdGl0bGU+XHJcbiAgICA8c3R5bGU+XHJcbiAgICAgICAgQGltcG9ydCB1cmwoXCJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2Nzcz9mYW1pbHk9UmFsZXdheTo5MDAmZGlzcGxheT1zd2FwXCIpO1xyXG5cclxuICAgICAgICBodG1sLFxyXG4gICAgICAgIGJvZHkge1xyXG4gICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgICAgICAgICAgIGhlaWdodDogMTAwJTtcclxuICAgICAgICAgICAgcGFkZGluZzogMDtcclxuICAgICAgICAgICAgbWFyZ2luOiAwO1xyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2IoMTAsIDEwLCAzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICN0ZXh0MSxcclxuICAgICAgICAjdGV4dDIge1xyXG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICAgICAgICAgIHRvcDogNDUlO1xyXG4gICAgICAgICAgICBsZWZ0OiA1MCU7XHJcbiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpO1xyXG4gICAgICAgICAgICBjb2xvcjogcGluaztcclxuICAgICAgICAgICAgZm9udC1mYW1pbHk6IFwiUmFsZXdheVwiLCBzYW5zLXNlcmlmO1xyXG4gICAgICAgICAgICBmb250LXNpemU6IDM1cHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjYW52YXMge1xyXG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgICAgICAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgICAgICAgfVxyXG4gICAgPC9zdHlsZT5cclxuPC9oZWFkPlxyXG5cclxuPGJvZHk+XHJcbiAgICA8cCBpZD1cInRleHQxXCI+PC9wPlxyXG4gICAgPHAgaWQ9XCJ0ZXh0MlwiPjwvcD5cclxuICAgIDxjYW52YXMgaWQ9XCJwaW5rYm9hcmRcIj48L2NhbnZhcz5cclxuICAgIDxzY3JpcHQ+XHJcbiAgICAgICAgY29uc3QgZWx0cyA9IHtcclxuICAgICAgICAgICAgdGV4dDE6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGV4dDFcIiksXHJcbiAgICAgICAgICAgIHRleHQyOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRleHQyXCIpLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgdGV4dHMgPSBbXCJJXCIsIFwiTG92ZVwiLCBcIllvdVwiLCBcIjMwMDBcIiwgXCLinaTvuI/inaTvuI/inaTvuI9cIl07XHJcbiAgICAgICAgY29uc3QgbW9ycGhUaW1lID0gMTtcclxuICAgICAgICBjb25zdCBjb29sZG93blRpbWUgPSAwLjI1O1xyXG4gICAgICAgIGxldCB0ZXh0SW5kZXggPSB0ZXh0cy5sZW5ndGggLSAxO1xyXG4gICAgICAgIGxldCB0aW1lID0gbmV3IERhdGUoKTtcclxuICAgICAgICBsZXQgbW9ycGggPSAwO1xyXG4gICAgICAgIGxldCBjb29sZG93biA9IGNvb2xkb3duVGltZTtcclxuICAgICAgICBlbHRzLnRleHQxLnRleHRDb250ZW50ID0gdGV4dHNbdGV4dEluZGV4ICUgdGV4dHMubGVuZ3RoXTtcclxuICAgICAgICBlbHRzLnRleHQyLnRleHRDb250ZW50ID0gdGV4dHNbKHRleHRJbmRleCArIDEpICUgdGV4dHMubGVuZ3RoXTtcclxuICAgICAgICBmdW5jdGlvbiBkb01vcnBoKCkge1xyXG4gICAgICAgICAgICBtb3JwaCAtPSBjb29sZG93bjtcclxuICAgICAgICAgICAgY29vbGRvd24gPSAwO1xyXG4gICAgICAgICAgICBsZXQgZnJhY3Rpb24gPSBtb3JwaCAvIG1vcnBoVGltZTtcclxuICAgICAgICAgICAgaWYgKGZyYWN0aW9uID4gMSkge1xyXG4gICAgICAgICAgICAgICAgY29vbGRvd24gPSBjb29sZG93blRpbWU7XHJcbiAgICAgICAgICAgICAgICBmcmFjdGlvbiA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2V0TW9ycGgoZnJhY3Rpb24pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0TW9ycGgoZnJhY3Rpb24pIHtcclxuICAgICAgICAgICAgZWx0cy50ZXh0Mi5zdHlsZS5maWx0ZXIgPSBgYmx1cigke01hdGgubWluKDggLyBmcmFjdGlvbiAtIDgsIDEwMCl9cHgpYDtcclxuICAgICAgICAgICAgZWx0cy50ZXh0Mi5zdHlsZS5vcGFjaXR5ID0gYCR7TWF0aC5wb3coZnJhY3Rpb24sIDAuNCkgKiAxMDB9JWA7XHJcbiAgICAgICAgICAgIGZyYWN0aW9uID0gMSAtIGZyYWN0aW9uO1xyXG4gICAgICAgICAgICBlbHRzLnRleHQxLnN0eWxlLmZpbHRlciA9IGBibHVyKCR7TWF0aC5taW4oOCAvIGZyYWN0aW9uIC0gOCwgMTAwKX1weClgO1xyXG4gICAgICAgICAgICBlbHRzLnRleHQxLnN0eWxlLm9wYWNpdHkgPSBgJHtNYXRoLnBvdyhmcmFjdGlvbiwgMC40KSAqIDEwMH0lYDtcclxuICAgICAgICAgICAgZWx0cy50ZXh0MS50ZXh0Q29udGVudCA9IHRleHRzW3RleHRJbmRleCAlIHRleHRzLmxlbmd0aF07XHJcbiAgICAgICAgICAgIGVsdHMudGV4dDIudGV4dENvbnRlbnQgPSB0ZXh0c1sodGV4dEluZGV4ICsgMSkgJSB0ZXh0cy5sZW5ndGhdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZG9Db29sZG93bigpIHtcclxuICAgICAgICAgICAgbW9ycGggPSAwO1xyXG4gICAgICAgICAgICBlbHRzLnRleHQyLnN0eWxlLmZpbHRlciA9IFwiXCI7XHJcbiAgICAgICAgICAgIGVsdHMudGV4dDIuc3R5bGUub3BhY2l0eSA9IFwiMTAwJVwiO1xyXG4gICAgICAgICAgICBlbHRzLnRleHQxLnN0eWxlLmZpbHRlciA9IFwiXCI7XHJcbiAgICAgICAgICAgIGVsdHMudGV4dDEuc3R5bGUub3BhY2l0eSA9IFwiMCVcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFuaW1hdGUoKSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKTtcclxuICAgICAgICAgICAgbGV0IG5ld1RpbWUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgICBsZXQgc2hvdWxkSW5jcmVtZW50SW5kZXggPSBjb29sZG93biA+IDA7XHJcbiAgICAgICAgICAgIGxldCBkdCA9IChuZXdUaW1lIC0gdGltZSkgLyAxMDAwO1xyXG4gICAgICAgICAgICB0aW1lID0gbmV3VGltZTtcclxuICAgICAgICAgICAgY29vbGRvd24gLT0gZHQ7XHJcbiAgICAgICAgICAgIGlmIChjb29sZG93biA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2hvdWxkSW5jcmVtZW50SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0SW5kZXgrKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGRvTW9ycGgoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRvQ29vbGRvd24oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBhbmltYXRlKCk7XHJcblxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICAqIFNldHRpbmdzXHJcbiAgICAgICAgICAqL1xyXG5cclxuICAgICAgICB2YXIgc2V0dGluZ3MgPSB7XHJcbiAgICAgICAgICAgIHBhcnRpY2xlczoge1xyXG4gICAgICAgICAgICAgICAgbGVuZ3RoOiA1MDAsXHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMixcclxuICAgICAgICAgICAgICAgIHZlbG9jaXR5OiAxMDAsXHJcbiAgICAgICAgICAgICAgICBlZmZlY3Q6IC0wLjc1LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogMzAsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLypcclxuICAgICAgICAgICogUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHBvbHlmaWxsIGJ5IEVyaWsgTcO2bGxlclxyXG4gICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSAwO1xyXG4gICAgICAgICAgICB2YXIgYyA9IFtcIm1zXCIsIFwibW96XCIsIFwid2Via2l0XCIsIFwib1wiXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCBjLmxlbmd0aCAmJiAhd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZTsgKythKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gd2luZG93W2NbYV0gKyBcIlJlcXVlc3RBbmltYXRpb25GcmFtZVwiXTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSA9XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93W2NbYV0gKyBcIkNhbmNlbEFuaW1hdGlvbkZyYW1lXCJdIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93W2NbYV0gKyBcIkNhbmNlbFJlcXVlc3RBbmltYXRpb25GcmFtZVwiXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIXdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiAoaCwgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSBNYXRoLm1heCgwLCAxNiAtIChkIC0gYikpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBnID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoKGQgKyBmKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBmKTtcclxuICAgICAgICAgICAgICAgICAgICBiID0gZCArIGY7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGc7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChkKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KSgpO1xyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgICAqIFBvaW50IGNsYXNzXHJcbiAgICAgICAgICAgICAgICAgICovXHJcblxyXG4gICAgICAgIHZhciBQb2ludCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIFBvaW50KHgsIHkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMueCA9IHR5cGVvZiB4ICE9PSBcInVuZGVmaW5lZFwiID8geCA6IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnkgPSB0eXBlb2YgeSAhPT0gXCJ1bmRlZmluZWRcIiA/IHkgOiAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFBvaW50LnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUG9pbnQodGhpcy54LCB0aGlzLnkpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBQb2ludC5wcm90b3R5cGUubGVuZ3RoID0gZnVuY3Rpb24gKGxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBsZW5ndGggPT0gXCJ1bmRlZmluZWRcIilcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy54ICo9IGxlbmd0aDtcclxuICAgICAgICAgICAgICAgIHRoaXMueSAqPSBsZW5ndGg7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgUG9pbnQucHJvdG90eXBlLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmxlbmd0aCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy54IC89IGxlbmd0aDtcclxuICAgICAgICAgICAgICAgIHRoaXMueSAvPSBsZW5ndGg7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmV0dXJuIFBvaW50O1xyXG4gICAgICAgIH0pKCk7XHJcblxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICAgICogUGFydGljbGUgY2xhc3NcclxuICAgICAgICAgICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgdmFyIFBhcnRpY2xlID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZnVuY3Rpb24gUGFydGljbGUoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gbmV3IFBvaW50KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZlbG9jaXR5ID0gbmV3IFBvaW50KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFjY2VsZXJhdGlvbiA9IG5ldyBQb2ludCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZ2UgPSAwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBQYXJ0aWNsZS5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICh4LCB5LCBkeCwgZHkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueCA9IHg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uLnkgPSB5O1xyXG4gICAgICAgICAgICAgICAgdGhpcy52ZWxvY2l0eS54ID0gZHg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZlbG9jaXR5LnkgPSBkeTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWNjZWxlcmF0aW9uLnggPSBkeCAqIHNldHRpbmdzLnBhcnRpY2xlcy5lZmZlY3Q7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFjY2VsZXJhdGlvbi55ID0gZHkgKiBzZXR0aW5ncy5wYXJ0aWNsZXMuZWZmZWN0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZ2UgPSAwO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgUGFydGljbGUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChkZWx0YVRpbWUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueCArPSB0aGlzLnZlbG9jaXR5LnggKiBkZWx0YVRpbWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uLnkgKz0gdGhpcy52ZWxvY2l0eS55ICogZGVsdGFUaW1lO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52ZWxvY2l0eS54ICs9IHRoaXMuYWNjZWxlcmF0aW9uLnggKiBkZWx0YVRpbWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZlbG9jaXR5LnkgKz0gdGhpcy5hY2NlbGVyYXRpb24ueSAqIGRlbHRhVGltZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWdlICs9IGRlbHRhVGltZTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIFBhcnRpY2xlLnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24gKGNvbnRleHQsIGltYWdlKSB7XHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBlYXNlKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLS10ICogdCAqIHQgKyAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIHNpemUgPSBpbWFnZS53aWR0aCAqIGVhc2UodGhpcy5hZ2UgLyBzZXR0aW5ncy5wYXJ0aWNsZXMuZHVyYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgY29udGV4dC5nbG9iYWxBbHBoYSA9IDEgLSB0aGlzLmFnZSAvIHNldHRpbmdzLnBhcnRpY2xlcy5kdXJhdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKFxyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueCAtIHNpemUgLyAyLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24ueSAtIHNpemUgLyAyLFxyXG4gICAgICAgICAgICAgICAgICAgIHNpemUsXHJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBQYXJ0aWNsZTtcclxuICAgICAgICB9KSgpO1xyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgICAqIFBhcnRpY2xlUG9vbCBjbGFzc1xyXG4gICAgICAgICAgICAgICAgICAqL1xyXG5cclxuICAgICAgICB2YXIgUGFydGljbGVQb29sID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBhcnRpY2xlcyxcclxuICAgICAgICAgICAgICAgIGZpcnN0QWN0aXZlID0gMCxcclxuICAgICAgICAgICAgICAgIGZpcnN0RnJlZSA9IDAsXHJcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IHNldHRpbmdzLnBhcnRpY2xlcy5kdXJhdGlvbjtcclxuICAgICAgICAgICAgZnVuY3Rpb24gUGFydGljbGVQb29sKGxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcGFydGljbGVzID0gbmV3IEFycmF5KGxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcnRpY2xlcy5sZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICBwYXJ0aWNsZXNbaV0gPSBuZXcgUGFydGljbGUoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgUGFydGljbGVQb29sLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoeCwgeSwgZHgsIGR5KSB7XHJcbiAgICAgICAgICAgICAgICBwYXJ0aWNsZXNbZmlyc3RGcmVlXS5pbml0aWFsaXplKHgsIHksIGR4LCBkeSk7XHJcbiAgICAgICAgICAgICAgICBmaXJzdEZyZWUrKztcclxuICAgICAgICAgICAgICAgIGlmIChmaXJzdEZyZWUgPT0gcGFydGljbGVzLmxlbmd0aCkgZmlyc3RGcmVlID0gMDtcclxuICAgICAgICAgICAgICAgIGlmIChmaXJzdEFjdGl2ZSA9PSBmaXJzdEZyZWUpIGZpcnN0QWN0aXZlKys7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlyc3RBY3RpdmUgPT0gcGFydGljbGVzLmxlbmd0aCkgZmlyc3RBY3RpdmUgPSAwO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgUGFydGljbGVQb29sLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZGVsdGFUaW1lKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaTtcclxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBhY3RpdmUgcGFydGljbGVzXHJcbiAgICAgICAgICAgICAgICBpZiAoZmlyc3RBY3RpdmUgPCBmaXJzdEZyZWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSBmaXJzdEFjdGl2ZTsgaSA8IGZpcnN0RnJlZTsgaSsrKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJ0aWNsZXNbaV0udXBkYXRlKGRlbHRhVGltZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlyc3RGcmVlIDwgZmlyc3RBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSBmaXJzdEFjdGl2ZTsgaSA8IHBhcnRpY2xlcy5sZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFydGljbGVzW2ldLnVwZGF0ZShkZWx0YVRpbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBmaXJzdEZyZWU7IGkrKykgcGFydGljbGVzW2ldLnVwZGF0ZShkZWx0YVRpbWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBpbmFjdGl2ZSBwYXJ0aWNsZXNcclxuXHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoXHJcbiAgICAgICAgICAgICAgICAgICAgcGFydGljbGVzW2ZpcnN0QWN0aXZlXS5hZ2UgPj0gZHVyYXRpb24gJiZcclxuICAgICAgICAgICAgICAgICAgICBmaXJzdEFjdGl2ZSAhPSBmaXJzdEZyZWVcclxuICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpcnN0QWN0aXZlKys7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdEFjdGl2ZSA9PSBwYXJ0aWNsZXMubGVuZ3RoKSBmaXJzdEFjdGl2ZSA9IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBQYXJ0aWNsZVBvb2wucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbiAoY29udGV4dCwgaW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgIC8vIGRyYXcgYWN0aXZlIHBhcnRpY2xlc1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChmaXJzdEFjdGl2ZSA8IGZpcnN0RnJlZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IGZpcnN0QWN0aXZlOyBpIDwgZmlyc3RGcmVlOyBpKyspXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpY2xlc1tpXS5kcmF3KGNvbnRleHQsIGltYWdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZmlyc3RGcmVlIDwgZmlyc3RBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSBmaXJzdEFjdGl2ZTsgaSA8IHBhcnRpY2xlcy5sZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFydGljbGVzW2ldLmRyYXcoY29udGV4dCwgaW1hZ2UpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZmlyc3RGcmVlOyBpKyspIHBhcnRpY2xlc1tpXS5kcmF3KGNvbnRleHQsIGltYWdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBQYXJ0aWNsZVBvb2w7XHJcbiAgICAgICAgfSkoKTtcclxuXHJcbiAgICAgICAgLypcclxuICAgICAgICAgICAgICAgICAgKiBQdXR0aW5nIGl0IGFsbCB0b2dldGhlclxyXG4gICAgICAgICAgICAgICAgICAqL1xyXG5cclxuICAgICAgICAoZnVuY3Rpb24gKGNhbnZhcykge1xyXG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiksXHJcbiAgICAgICAgICAgICAgICBwYXJ0aWNsZXMgPSBuZXcgUGFydGljbGVQb29sKHNldHRpbmdzLnBhcnRpY2xlcy5sZW5ndGgpLFxyXG4gICAgICAgICAgICAgICAgcGFydGljbGVSYXRlID0gc2V0dGluZ3MucGFydGljbGVzLmxlbmd0aCAvIHNldHRpbmdzLnBhcnRpY2xlcy5kdXJhdGlvbiwgLy8gcGFydGljbGVzL3NlY1xyXG4gICAgICAgICAgICAgICAgdGltZTtcclxuXHJcbiAgICAgICAgICAgIC8vIGdldCBwb2ludCBvbiBoZWFydCB3aXRoIC1QSSA8PSB0IDw9IFBJXHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBwb2ludE9uSGVhcnQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQb2ludChcclxuICAgICAgICAgICAgICAgICAgICAxNjAgKiBNYXRoLnBvdyhNYXRoLnNpbih0KSwgMyksXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIDEzMCAqIE1hdGguY29zKHQpIC1cclxuICAgICAgICAgICAgICAgICAgICA1MCAqIE1hdGguY29zKDIgKiB0KSAtXHJcbiAgICAgICAgICAgICAgICAgICAgMjAgKiBNYXRoLmNvcygzICogdCkgLVxyXG4gICAgICAgICAgICAgICAgICAgIDEwICogTWF0aC5jb3MoNCAqIHQpICtcclxuICAgICAgICAgICAgICAgICAgICAyNVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gY3JlYXRpbmcgdGhlIHBhcnRpY2xlIGltYWdlIHVzaW5nIGEgZHVtbXkgY2FudmFzXHJcblxyXG4gICAgICAgICAgICB2YXIgaW1hZ2UgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMud2lkdGggPSBzZXR0aW5ncy5wYXJ0aWNsZXMuc2l6ZTtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBzZXR0aW5ncy5wYXJ0aWNsZXMuc2l6ZTtcclxuICAgICAgICAgICAgICAgIC8vIGhlbHBlciBmdW5jdGlvbiB0byBjcmVhdGUgdGhlIHBhdGhcclxuXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiB0byh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvaW50ID0gcG9pbnRPbkhlYXJ0KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBvaW50LnggPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncy5wYXJ0aWNsZXMuc2l6ZSAvIDIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAocG9pbnQueCAqIHNldHRpbmdzLnBhcnRpY2xlcy5zaXplKSAvIDM1MDtcclxuICAgICAgICAgICAgICAgICAgICBwb2ludC55ID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MucGFydGljbGVzLnNpemUgLyAyIC1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKHBvaW50LnkgKiBzZXR0aW5ncy5wYXJ0aWNsZXMuc2l6ZSkgLyAzNTA7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvaW50O1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSB0aGUgcGF0aFxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdCA9IC1NYXRoLlBJO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBvaW50ID0gdG8odCk7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0Lm1vdmVUbyhwb2ludC54LCBwb2ludC55KTtcclxuICAgICAgICAgICAgICAgIHdoaWxlICh0IDwgTWF0aC5QSSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQgKz0gMC4wMTsgLy8gYmFieSBzdGVwcyFcclxuICAgICAgICAgICAgICAgICAgICBwb2ludCA9IHRvKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQubGluZVRvKHBvaW50LngsIHBvaW50LnkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBjcmVhdGUgdGhlIGZpbGxcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCIjZWE4MGIwXCI7XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBjcmVhdGUgdGhlIGltYWdlXHJcbiAgICAgICAgICAgICAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcclxuICAgICAgICAgICAgICAgIGltYWdlLnNyYyA9IGNhbnZhcy50b0RhdGFVUkwoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpbWFnZTtcclxuICAgICAgICAgICAgfSkoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIHJlbmRlciB0aGF0IHRoaW5nIVxyXG4gICAgICAgICAgICBmdW5jdGlvbiByZW5kZXIoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBuZXh0IGFuaW1hdGlvbiBmcmFtZVxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHJlbmRlcik7XHJcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgdGltZVxyXG4gICAgICAgICAgICAgICAgdmFyIG5ld1RpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgZGVsdGFUaW1lID0gbmV3VGltZSAtICh0aW1lIHx8IG5ld1RpbWUpO1xyXG4gICAgICAgICAgICAgICAgdGltZSA9IG5ld1RpbWU7XHJcbiAgICAgICAgICAgICAgICAvLyBjbGVhciBjYW52YXNcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAvLyBjcmVhdGUgbmV3IHBhcnRpY2xlc1xyXG4gICAgICAgICAgICAgICAgdmFyIGFtb3VudCA9IHBhcnRpY2xlUmF0ZSAqIGRlbHRhVGltZTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW1vdW50OyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gcG9pbnRPbkhlYXJ0KE1hdGguUEkgLSAyICogTWF0aC5QSSAqIE1hdGgucmFuZG9tKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkaXIgPSBwb3MuY2xvbmUoKS5sZW5ndGgoc2V0dGluZ3MucGFydGljbGVzLnZlbG9jaXR5KTtcclxuICAgICAgICAgICAgICAgICAgICBwYXJ0aWNsZXMuYWRkKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMud2lkdGggLyAyICsgcG9zLngsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgLyAyIC0gcG9zLnksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpci54LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAtZGlyLnlcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBhbmQgZHJhdyBwYXJ0aWNsZXNcclxuXHJcbiAgICAgICAgICAgICAgICBwYXJ0aWNsZXMudXBkYXRlKGRlbHRhVGltZSk7XHJcbiAgICAgICAgICAgICAgICBwYXJ0aWNsZXMuZHJhdyhjb250ZXh0LCBpbWFnZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGhhbmRsZSAocmUtKXNpemluZyBvZiB0aGUgY2FudmFzXHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBvblJlc2l6ZSgpIHtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IGNhbnZhcy5jbGllbnRXaWR0aDtcclxuICAgICAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBjYW52YXMuY2xpZW50SGVpZ2h0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHdpbmRvdy5vbnJlc2l6ZSA9IG9uUmVzaXplO1xyXG4gICAgICAgICAgICAvLyBkZWxheSByZW5kZXJpbmcgYm9vdHN0cmFwXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgb25SZXNpemUoKTtcclxuICAgICAgICAgICAgICAgIHJlbmRlcigpO1xyXG4gICAgICAgICAgICB9LCAxMCk7XHJcblxyXG4gICAgICAgICAgICAvLyBSZWRpcmVjdCB0byBNZXNzZW5nZXJcclxuICAgICAgICAgICAgLy8gXHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8gXHRcdHdpbmRvdy5vcGVuKFxyXG4gICAgICAgICAgICAvLyBcdFx0XHRcImh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS9tZXNzYWdlcy90LzEwMDAxNDIyOTQwMjMxN1wiLFxyXG4gICAgICAgICAgICAvLyBcdFx0XHRcIl9ibGFua1wiXHJcbiAgICAgICAgICAgIC8vIFx0XHQpO1xyXG4gICAgICAgICAgICAvLyBcdH0sIDEwMDAwKTtcclxuXHJcbiAgICAgICAgICAgIC8vIE9wZW4gdG8gTWVzc2VuZ2VyXHJcbiAgICAgICAgICAgIC8vIFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9XHJcbiAgICAgICAgICAgIC8vIFx0XHRcdFwiaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL21lc3NhZ2VzL3QvMTAwMDE0MjI5NDAyMzE3XCI7XHJcbiAgICAgICAgICAgIC8vIFx0fSwgMzAwMDApO1xyXG5cclxuICAgICAgICAgICAgLy8gRW5kXHJcbiAgICAgICAgfSkoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaW5rYm9hcmRcIikpO1xyXG5cclxuICAgIDwvc2NyaXB0PlxyXG5cclxuPC9ib2R5PlxyXG5cclxuPC9odG1sPiJ9XX0="
}